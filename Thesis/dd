# Hydraulic Calculations

Hydraulic behavior is extracted directly from the solver through the per step pressure drop decomposition implemented in `heat/solver.py` (`_gas_dp_components`, `pressure_drop_gas`) and accumulated at the stage level in `heat/solver.py::solve_stage`.

The model divides gas side pressure losses into:

- Frictional losses:  
  Computed by Colebrookâ€“White (turbulent), laminar 64/Re, and a linear transitional blend for 2300 < $\mathrm{Re} < 4000$.  
  The per step drop is $$\Delta P_{\mathrm{fric}} = - f \frac{\Delta x}{D_h}\left(\frac{\rho V^2}{2}\right)$$ where $f$ is obtained from `_friction_factor()` and hydraulic diameter, velocity, and density come from the local gas state, and stage geometry.

- Minor losses:  
  Applied using per stage catalogue $K$ values.  
  For reversal chambers, inlet/outlet nozzle $K$ plus bend equivalent loss are included; other stages default to zero unless specified.

  In `solve_stage`, the total per-stage loss coefficient $K_{\mathrm{sum}}$ is uniformly distributed across $N$ steps:
  $$K_{\mathrm{per\,step}} = \frac{K_{\mathrm{sum}}}{N}$$  
  The per step minor loss is  
  $$\Delta P_{\mathrm{minor}} = -K_{\mathrm{per\,step}}\left(\frac{\rho V^2}{2}\right)$$

- Total gas side drop:  
  $$\Delta P_{\mathrm{total}} = \Delta P_{\mathrm{fric}} + \Delta P_{\mathrm{minor}}$$

Water side pressure losses are intentionally not included in this model (water at constant drum pressure).